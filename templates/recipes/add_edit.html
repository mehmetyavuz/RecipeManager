<h3>
    <a href="{% url 'recipes:index' %}">All Recipes</a>
</h3>

<form id="form-recipe" onsubmit="submit_form()">
    {% csrf_token %}

    {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

    <label for="name">Recipe name:</label>
    <input type="text" name="name" value="{{ recipe.name }}">

    <table>
        <thead>
        <tr>
            <th>Ingredient</th>
            <th>Unit Cost</th>
            <th>Amount</th>
            <th>Cost</th>
        </tr>
        </thead>
        <tbody>
        {% for ri in recipe.recipeingredient_set.all %}
            <tr>
                <td>{{ ri.ingredient.name }}</td>
                <td>{{ ri.ingredient.description }}</td>
                <td>
                    <input type="number" name="amount_{{ ri.id }}" value="{{ ri.amount }}">
                </td>
                <td>{{ ri.cost }}</td>
            </tr>
        {% endfor %}
        </tbody>
        <tfoot>
        <tr>
            <th colspan="3" class="text-right">Total:</th>
            <th>{{ recipe.total_cost }}</th>
        </tr>
        </tfoot>
    </table>


    <input type="submit" value="Submit">
</form>

<script>
    function submit_form(e) {
        e.preventDefault();
        debugger;
        let form = document.getElementById('form-recipe');
        let data = new FormData(form);
        fetch('{% url 'recipes:edit' recipe.id %}', {
            method: "POST",
            body: data,
        }).then(alert('Post created!'));
    }
</script>